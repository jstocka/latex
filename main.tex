% !TeX encoding = UTF-8
\documentclass[12pt,a4paper]{report}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[polish,english]{babel}
\usepackage{csquotes}
\usepackage{titlesec}
\usepackage[
    left=25mm, 
    right=25mm, 
    top=25mm, 
    bottom=25mm,
    bindingoffset=0cm
]{geometry}
\usepackage{setspace}
\onehalfspacing
\usepackage{indentfirst}
\usepackage{ragged2e}
\justifying
\usepackage{fancyhdr}
\fancypagestyle{plain}{%
   \fancyhf{}
   \fancyfoot[C]{\thepage}
   \renewcommand{\headrulewidth}{0pt}
}
\pagestyle{plain}

\usepackage[style=numeric,sorting=nyt,maxbibnames=99,maxcitenames=2,giveninits=false,doi=false,defernumbers=true]{biblatex}
\addbibresource{bibliografia.bib}
\DeclareFieldFormat{urldate}{\space\linebreak[1][DOA: #1]}
\usepackage{url}

% Ukryj domyślne drukowanie daty (poza tytułem)
\renewbibmacro*{date}{}
% Makro tytułu + roku po tytule
\newbibmacro*{title+year}{%
  \printfield[title]{title}%
  \iffieldundef{year}
    {}
    {\addspace\printtext[parens]{\printdate}}%
  \newunit}

% Sterownik dla książek
\DeclareBibliographyDriver{book}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others}%
  \newunit\newblock
  \usebibmacro{title+year}%
  \newunit\newblock
  \printlist{publisher}%
  \newunit\newblock
  \usebibmacro{finentry}}

% Sterownik dla prac magisterskich
\DeclareBibliographyDriver{mastersthesis}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others}%
  \newunit\newblock
  \usebibmacro{title+year}%
  \newunit\newblock
  \printfield{type}%
  \newunit\newblock
  \printlist{institution}%
  \newunit\newblock
  \usebibmacro{finentry}}

% Sterownik dla źródeł online
\DeclareBibliographyDriver{online}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others}%
  \newunit\newblock
  \usebibmacro{title+year}%
  \newunit\newblock
  \printfield{organization}%
  \newunit\newblock
  \printfield{url}%
  \newunit\newblock
  \usebibmacro{urldate}%  % tutaj ważna zmiana
  \newunit\newblock
  \usebibmacro{finentry}}

% Sterownik dla misc
\DeclareBibliographyDriver{misc}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others}%
  \newunit\newblock
  \usebibmacro{title+year}%
  \newunit\newblock
  \printfield{howpublished}%
  \newunit\newblock
  \usebibmacro{finentry}}

\usepackage{graphicx}
\usepackage{caption}
\DeclareCaptionFont{tenpt}{\fontsize{10pt}{12pt}\selectfont}
\captionsetup{
  font=tenpt,
  labelfont=bf,
  justification=centering,
}

\usepackage{subcaption}
\usepackage{enumitem}[shortlabels]
\setlist[itemize]{nosep}
\setlist{noitemsep}
\renewcommand{\labelitemi}{$\bullet$}
\usepackage[titles]{tocloft}
\renewcommand{\cftdot}{}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecaftersnum}{.}%

\newlength{\chapterspace}
\setlength{\chapterspace}{2\baselineskip}

 \titleformat{\chapter}[display]
   {\normalfont\fontsize{14}{16.8}\bfseries\centering}
   {\vspace*{-20pt}\chaptertitlename~\thechapter}
   {0pt}
   {\normalfont\fontsize{14}{16.8}\bfseries\centering}

\titleformat{name=\chapter,numberless}[display]
 {\normalfont\fontsize{14}{16.8}\bfseries\centering}
 {\vspace*{-40pt}}
 {0pt}
 {\normalfont\fontsize{14}{16.8}\bfseries\centering}

\titlespacing*{\chapter}
 {0pt}
 {0pt}
 {\chapterspace}

\titlespacing*{name=\chapter,numberless}
 {0pt}
 {0pt}
 {\chapterspace}

 \newcommand{\firstchapter}[1]{%
  \chapter*{#1}
  \addcontentsline{toc}{chapter}{#1}
}

\titleformat{\section}
{\normalfont\fontsize{12}{14.4}\bfseries}
{\thesection}
{0.5em}
{\normalfont\fontsize{12}{14.4}\bfseries}

\titleformat{name=\section,numberless}
{\normalfont\fontsize{12}{14.4}\bfseries}
{}
{0pt}
{\normalfont\fontsize{12}{14.4}\bfseries}

\titlespacing*{\section}
 {0pt}
 {1em}
 {0pt}

\titlespacing*{name=\section,numberless}
 {0pt}
 {1em}
 {0pt}

\titleformat{\subsection}
 {\normalfont\fontsize{12}{14.4}\bfseries}
 {\thesubsection}
 {1em}
 {}

\let\oldquote\quote
\let\endoldquote\endquote

\renewenvironment{quote}
{
   \oldquote
   \small
   \setlength{\leftmargin}{1.25cm}
   \setlength{\rightmargin}{1.25cm}
   \setstretch{1}
}
{\endoldquote}

\makeatletter
\renewcommand{\maketitle}{
   \begin{titlepage}
   \pagestyle{empty}
   \begin{center}
       \Large
       UNIWERSYTET KAZIMIERZA WIELKIEGO\\
       KOLEGIUM IV\\[0.5cm]
       INSTYTUT KOMUNIKACJI SPOŁECZNEJ I MEDIÓW\\[2cm]
       
       \large
       Julia Stocka\\[0.5cm]
       
       98057\\[2cm]
       
       \textbf{Mechaniki w wybranych grach rytmicznych oraz ich wpływ \\ na immersję i flow}\\[4cm]
       
       \normalsize
       \raggedleft
        Praca licencjacka napisana pod kierunkiem\\
       doktora Miłosza Markockiego\\[4cm]
       \centering
       BYDGOSZCZ 2025\\[1cm]
   \end{center}
   \end{titlepage}

   \begin{titlepage}
   \pagestyle{empty}
   \begin{center}
       \Large
       UNIWERSYTET KAZIMIERZA WIELKIEGO\\
       KOLEGIUM IV\\[0.5cm]
       INSTYTUT KOMUNIKACJI SPOŁECZNEJ I MEDIÓW\\[2cm]
       
       \large
       Julia Stocka\\[0.5cm]
       
       98057\\[2cm]
       
       \textbf{Mechanics in Selected Rhythm Games and Their Impact \\ on Immersion and Flow}\\[4cm]
       
       \normalsize
       \raggedleft
       Bachelor's thesis written under the supervision of\\
       Doctor Miłosz Markocki\\[4cm]
       \centering
       BYDGOSZCZ 2025\\[1cm]
   \end{center}
   \end{titlepage}
}

\renewcommand{\listoffigures}{%
  \chapter*{\listfigurename}%
  \vspace{-0.5\baselineskip}%
  \@starttoc{lof}%
}

\makeatother

\usepackage[hidelinks]{hyperref}
\urlstyle{same}

\begin{document}
\pagenumbering{gobble}
\maketitle

\input{oswiadczenie}

\chapter*{Summary}
\addcontentsline{toc}{chapter}{Summary}
\input{summary.tex}

\chapter*{Streszczenie}
\input{summarypl.tex}

\cleardoublepage
\pagenumbering{arabic}
\setcounter{page}{6}

\tableofcontents

\firstchapter{Introduction}
\label{chap:wstep}
\input{rozdzialy/introduction}

\chapter{Rhythm Games}
\label{chap:rozdzial1}
\input{rozdzialy/chapter2}

\chapter{Player's engagement - social and cultural aspects of rhythm games}
\label{chap:rozdzial2}
\input{rozdzialy/chapter3}

\firstchapter{Conclusion}
\label{chap:podsumowanie}
\input{rozdzialy/summary}

\printbibliography[title={Bibliography}]
\addcontentsline{toc}{chapter}{Bibliography}

\chapter*{Ludography}
\input{ludography.tex}

\addcontentsline{toc}{chapter}{Ludography}

\listoffigures
\addcontentsline{toc}{chapter}{List of Figures}

\end{document}